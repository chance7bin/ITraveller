(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/vehicleStrategy/index"],{"072a":function(t,i,e){"use strict";var a=e("c02f"),s=e.n(a);s.a},"2ed1":function(t,i,e){"use strict";var a,s=function(){var t=this,i=t.$createElement;t._self._c},n=[];e.d(i,"b",function(){return s}),e.d(i,"c",function(){return n}),e.d(i,"a",function(){return a})},"36b7":function(t,i,e){"use strict";e.r(i);var a=e("5710"),s=e.n(a);for(var n in a)"default"!==n&&function(t){e.d(i,t,function(){return a[t]})}(n);i["default"]=s.a},5710:function(t,i,e){"use strict";(function(t){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;a(e("a49d"));function a(t){return t&&t.__esModule?t:{default:t}}var s={data:function(){return{currentVehicle:"",currentIndex:10,markers:[],scale:16,longitude:"118.108245",latitude:"24.486208",desLng:"",desLat:"",paths:[],drivingPaths:[],transitPaths:[],walkingPaths:[{strategy:"推荐",duration:0,distance:0,steps:[]}],bicyclingPaths:[{strategy:"推荐",duration:0,distance:0,steps:[]}],polyline:[]}},onLoad:function(t){console.log("option:",t),console.log("currentIndex:",this.currentIndex),0==t.toVehivle?(this.latitude=getApp().globalData.currentLat,this.longitude=getApp().globalData.currentLng,getApp().globalData.originAddress.lat=this.latitude,getApp().globalData.originAddress.lng=this.longitude):(this.latitude=getApp().globalData.originAddress.lat,this.longitude=getApp().globalData.originAddress.lng),this.currentVehicle=t.vehicle,this.desLat=getApp().globalData.destinationAddress.lat,this.desLng=getApp().globalData.destinationAddress.lng,console.log("this.latitude:",this.latitude),console.log("this.longitude:",this.longitude),console.log("this.desLat:",this.desLat),console.log("this.desLng:",this.desLng);var i={originAddress:getApp().globalData.originAddress,destinationAddress:getApp().globalData.destinationAddress};getApp().globalData.historySearch.unshift(i),this.transitStrategy(this.desLng,this.desLat,this.longitude,this.latitude),this.drivingStrategy(this.desLng,this.desLat,this.longitude,this.latitude),this.walkingStrategy(this.desLng,this.desLat,this.longitude,this.latitude),this.bicyclingStrategy(this.desLng,this.desLat,this.longitude,this.latitude),this.markers=[{iconPath:"../../static/images/mapicon_navi_s.png",id:0,latitude:this.latitude,longitude:this.longitude,width:24,height:36},{iconPath:"../../static/images/mapicon_navi_e.png",id:1,latitude:this.desLat,longitude:this.desLng,width:24,height:36}]},onShow:function(){"driving"==this.currentVehicle&&(this.paths=this.drivingPaths),"transit"==this.currentVehicle&&(this.paths=this.transitPaths),"walking"==this.currentVehicle&&(this.paths=this.walkingPaths),"bicycling"==this.currentVehicle&&(this.paths=this.bicyclingPaths)},methods:{markerClick:function(){},drivingStrategy:function(i,e,a,s){var n=this;t.request({url:"https://restapi.amap.com/v3/direction/driving",data:{key:"cb003321f848fc897f55ca40cf0e6b01",origin:a+","+s,destination:i+","+e,strategy:10},success:function(t){var i=t.data.route.paths;if(i.length<=3)for(var e=0;e<i.length;e++)n.drivingPaths.push({strategy:"方案"+(e+1),duration:Math.ceil(i[e].duration/60),distance:(i[e].distance/1e3).toFixed(2),steps:i[e].steps});else for(e=0;e<3;e++)n.drivingPaths.push({strategy:"方案"+(e+1),duration:Math.ceil(i[e].duration/60),distance:(i[e].distance/1e3).toFixed(2),steps:i[e].steps})}})},transitStrategy:function(i,e,a,s){var n=this;t.request({url:"http://api.map.baidu.com/direction/v2/transit",data:{ak:"wRIcvin1aGUAAwXcM7tyRQwdZFyv9wnP",origin:s+","+a,destination:e+","+i},success:function(t){var i=t.data.result.routes;if(console.log("tempPaths:",i),i.length<=3)for(var e=0;e<i.length;e++)n.transitPaths.push({strategy:"方案"+(e+1),duration:Math.ceil(i[e].duration/60),distance:(i[e].distance/1e3).toFixed(2),steps:i[e].steps});else for(e=0;e<3;e++)n.transitPaths.push({strategy:"方案"+(e+1),duration:Math.ceil(i[e].duration/60),distance:(i[e].distance/1e3).toFixed(2),steps:i[e].steps})}})},walkingStrategy:function(i,e,a,s){var n=this;t.request({url:"https://restapi.amap.com/v3/direction/walking",data:{key:"cb003321f848fc897f55ca40cf0e6b01",origin:a+","+s,destination:i+","+e},success:function(t){console.log(t.data);var i=t.data.route.paths[0];n.walkingPaths[0].duration=Math.ceil(i.duration/60),n.walkingPaths[0].distance=(i.distance/1e3).toFixed(2),n.walkingPaths[0].steps=i.steps}})},bicyclingStrategy:function(i,e,a,s){var n=this;t.request({url:"https://restapi.amap.com/v4/direction/bicycling",data:{key:"cb003321f848fc897f55ca40cf0e6b01",origin:a+","+s,destination:i+","+e},success:function(t){console.log(t.data);var i=t.data.data.paths[0];n.bicyclingPaths[0].duration=Math.ceil(i.duration/60),n.bicyclingPaths[0].distance=(i.distance/1e3).toFixed(2),n.bicyclingPaths[0].steps=i.steps}})},chooseDrivingStrategy:function(t){console.log("e:",t);var i=t;this.currentIndex=t;for(var e=[],a=this.paths[i].steps,s=[],n=0;n<a.length;n++){s.push({no:n,instruction:a[n].instruction});for(var o=a[n].polyline.split(";"),r=0;r<o.length;r++)e.push({longitude:parseFloat(o[r].split(",")[0]),latitude:parseFloat(o[r].split(",")[1])})}getApp().globalData.routeDetail=s,this.polyline=[{points:e,color:"#0091ff",width:6}],this.scale=12},chooseTransitStrategy:function(t){var i=t;this.currentIndex=t;for(var e=[],a=this.paths[i].steps,s=[],n=0;n<a.length;n++){s.push({no:n,instruction:a[n][0].instructions});for(var o=a[n][0].path.split(";"),r=0;r<o.length;r++)e.push({longitude:parseFloat(o[r].split(",")[0]),latitude:parseFloat(o[r].split(",")[1])})}getApp().globalData.routeDetail=s,this.polyline=[{points:e,color:"#0091ff",width:6}],this.scale=12},routeDetail:function(){0==this.paths.length?t.showModal({title:"提示",content:"无路线详情",showCancel:!1,confirmText:"确定"}):0!=this.paths.length&&10==this.currentIndex?t.showModal({title:"提示",content:"请选择路线方案",showCancel:!1,confirmText:"确定"}):t.navigateTo({url:"../route/routeDetail"})}}};i.default=s}).call(this,e("543d")["default"])},"8d96":function(t,i,e){"use strict";(function(t){e("5df2"),e("921b");a(e("66fd"));var i=a(e("d20a"));function a(t){return t&&t.__esModule?t:{default:t}}t(i.default)}).call(this,e("543d")["createPage"])},c02f:function(t,i,e){},d20a:function(t,i,e){"use strict";e.r(i);var a=e("2ed1"),s=e("36b7");for(var n in s)"default"!==n&&function(t){e.d(i,t,function(){return s[t]})}(n);e("072a");var o,r=e("f0c5"),l=Object(r["a"])(s["default"],a["b"],a["c"],!1,null,"c9dfe9c4",null,!1,a["a"],o);i["default"]=l.exports}},[["8d96","common/runtime","common/vendor"]]]);